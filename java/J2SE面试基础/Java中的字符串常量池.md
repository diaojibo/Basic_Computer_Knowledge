## Java中的字符串常量池

Java中字符串对象创建有两种形式，一种为字面量形式，如String str = "droid";，另一种就是使用new这种标准的构造对象的方法，如String str = new String("droid");，这两种方式我们在代码编写时都经常使用，尤其是字面量的方式。然而这两种实现其实存在着一些性能和内存占用的差别。这一切都是源于JVM为了减少字符串对象的重复创建，其维护了一个特殊的内存，这段内存被成为字符串常量池或者字符串字面量池。

HotSpot中，字符串常量池在java7以前都在方法区，也就是永久代里。JDK 1.7 和 1.8 将字符串常量由永久代转移到堆中，并且 JDK 1.8 中已经不存在永久代了。

### 原理
当代码中出现字面量形式创建字符串对象时，JVM首先会对这个字面量进行检查，如果字符串常量池中存在相同内容的字符串对象的引用，则将这个引用返回，否则新的字符串对象被创建，然后将这个引用放入字符串常量池，并返回该引用。

比如我们用String str1 = "xxx" 创建了一个String对象，然后我们再String str2 = "xxx";

这时如果执行代码System.out.println(str1 == str2);

会发现结果为true。因为，str1的创建，在JVM在字符串常量池里创建了这个对象，第二个str2创建时，会先去常量池找，如果有就会返回一个相同的引用，指向同一个对象【注意常量池中存放的是String对象的引用】。

new创建则没有上面机理，每次必定会创建一个新的对象。

**注意字符串常量池实现的前提条件就是Java中String对象是不可变的**

### String的intern方法
调用intern后，首先检查字符串常量池中是否有该对象的引用，如果存在，则将这个引用返回给变量，否则将引用加入并返回给变量
