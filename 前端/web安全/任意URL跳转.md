## 任意URL跳转
某些业务场景（例如登录跳转、导航前进后退）会接受不信任的用户输入，并返回一个302响应或者URL重定向。因此攻击者通过操控输入的URL，可以欺骗用户跳转到不安全的页面，造成钓鱼攻击。以下是示例危险代码：

``` php
$redirect_url = $_GET['url'];
 header("Location: " . $redirect_url);//根据url=xxxx 生成302跳转

 //黑客发送以下链接给受害用户，用户将遭受到钓鱼攻击
 //http://example.qq.com/example.php?url=http://qq.evil.com/login


```

### 防护方案
 - 尽量避免这种提供URL跳转、重定向的功能
 - 尽量不要根据用户输入的URL参数拼接，进行跳转、重定向。
 - 根据业务场景，后台配置允许跳转的目录和信任的域名列表，仅允许在白名单里跳转。陷阱！注意使用 in 数组/列表来精确匹配判断，或者使用带^$包围的正则以防止部分匹配致绕过（腾讯域名正则参考安全规范3.3章节）。

 	如果无法限制用户输入，建议提供中间页面明确告知用户将离开本站。
