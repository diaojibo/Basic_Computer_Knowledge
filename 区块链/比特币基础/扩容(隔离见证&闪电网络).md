## 隔离见证&闪电网络
在比特币中，**见证（witness）通常指的是锁定脚本(unlocking script)和解锁脚本(scriptSig)**,在之前对于比特币交易的学习中我们知道锁定脚本与解锁脚本都是交易(transcation)的一部分。顾名思义，**隔离见证就是指将锁定脚本与解锁脚本中的部分内容从交易中分离出来，放入一个独立的数据结构中。隔离见证简称Segwit**

### Segwit工作机制
目前Segwit支持P2PKH与P2SH支付，加入隔离见证的交易取名为P2WPKH与P2WSH，分别来看一下他们的区别。

回忆一下之前锁定脚本和解锁脚本的内容，P2PKH的流程就是判断两边的公钥哈希等不等，相等的话就进行公私解锁。而P2SH则是多重签名。

简单对比一下P2PKH：

```
scriptSig(解锁脚本):    <signature> <pubkey>
scriptPubKey(锁定脚本): OP_DUP OP_HASH160 <20-byte hash of Pubkey> OP_EQUALVERIFY OP_CHECKSIG
```

加入了隔离见证的P2WPKH：

```
scriptSig(解锁脚本):    (empty)
scriptPubKey(锁定脚本): 0 <20-byte hash of Pubkey>
witness:      <signature> <pubkey>
```

P2WPKH的锁定脚本较P2PKH要精简不少，第一位的数字0是版本号，有了版本号，未来脚本升级就能更容易的向前兼容。**P2WPKH的解锁脚本为空**，而真正的解锁脚本内容被移到了原交易之外的witness部分。

#### P2WSH(Pay-to-Witness-Script-Hash)
P2WSH锁定脚本与P2WPKH类似

```
P2SH
  scriptSig:    0 <SigA> <SigB> <2 PubkeyA PubkeyB PubkeyC PubkeyD PubkeyE 5 CHECKMULTISIG>
  scriptPubKey: HASH160 <20-byte hash of redeem script> EQUAL
P2WSH  
  scriptSig:    (empty)
  scriptPubKey: 0 <32-byte hash of redeem script>
  witness:      0 <SigA> <SigB> <2 PubkeyA PubkeyB PubkeyC PubkeyD PubkeyE 5 CHECKMULTISIG>
```
